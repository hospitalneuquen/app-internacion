<!-- Tabla de evoluciones -->
<div ng-controller="internacion/iEvolucionar">

    <div class="card card-block" ng-show="show_toolbar">
        <div class="row">
            <div class="col-xs-4 col-lg-6">
                <h3>Evoluciones del paciente</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-4 col-lg-2">
                <select class="form-control" label="Tipo de evolución" ng-model="filtros.tipo" ng-change="filtros.filtrar()" plex="(tipo.nombre) for tipo in tipos"></select>
            </div>
            <div class="col-xs-4 col-lg-2">
                <select class="form-control" label="Tipo de profesional" ng-model="filtros.profesional" ng-change="filtros.filtrar()" plex="(profesional.nombre) for profesional in profesionales"></select>
            </div>
            <div class="col-xs-6 col-lg-2">
                <select class="form-control" label="Servicio" ng-model="filtros.servicio" ng-change="filtros.filtrar()" plex="(servicio.nombreCorto) for servicio in servicios"></select>
            </div>

            <div class="col-xs-2 col-lg-2 text-right" ng-if="internacion.estado != 'egresado'" ng-show="show_toolbar">
                <br/>
                <button class="btn btn-primary form-control" ng-click="editarEvolucion();">
                    Nueva evolución
                </button>
            </div>
        </div>

        <table class="table table-hover table-striped" ng-if="internacion.evoluciones && internacion.evoluciones.length > 0" ng-if="!evolucionesEdit">
            <thead >
                <tr>
                    <th >
                        Fecha
                    </th>
                    <th style="width: 80%;">
                        Detalle / Valores evolución
                    </th>
                    <th>
                        Ver
                    </th>
                    <th >
                        Usuario / Servicio
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="1"></td>
                    <td>
                        <b>Balance global de líquidos:</b>
                        {{balanceTotal}}
                        ml
                        <i class="verde mdi mdi-trending-up" ng-if="balanceTotal < 0"></i>
                        <i class="celeste mdi mdi-trending-flat" ng-if="balanceTotal == 0"></i>
                        <i class="rojo mdi mdi-trending-down" ng-if="balanceTotal > 0"></i>
                    </td>
                    <td colspan="3"></td>
                </tr>
                <tr data-ng-repeat="item in filtros.evoluciones | orderBy: '-fechaHora'">
                    <pre>
                        {{item | json}}
                    </pre>
                    <td >
                        {{item.fechaHora | fromNow }}<br/>
                        <div class="text-muted small">
                            {{item.fechaHora | date: "dd/MM/yyyy HH:mm"}}
                        </div>
                    </td>
                    <td >
                        <div ng-if="item.tipo == 'Servicio'">
                            <b>Evolución del servicio {{item.servicio.nombreCorto}}</b>
                        </div>
                        <div ng-bind-html="item.texto" ng-if="item.texto">
                            <br/>
                        </div>

                        <div ng-if="item.signosVitales">
                            <table width="100%">
                                <tr>
                                    <td ng-if="item.signosVitales.pulso">
                                        <b>
                                            Frecuencia cardíaca
                                        </b>
                                        <br/>
                                        {{item.signosVitales.pulso}}
                                        PPM
                                    </td>
                                    <td ng-if="item.signosVitales.circulacion.tensionDiastolica && item.signosVitales.circulacion.tensionSistolica">
                                        <b>
                                            Tensión
                                        </b>
                                        <br/>
                                        {{item.signosVitales.circulacion.tensionSistolica + "/" + item.signosVitales.circulacion.tensionDiastolica}}
                                    </td>
                                    <td ng-if="item.signosVitales.temperatura">
                                        <b>Temperatura</b>
                                        <br/>
                                        {{item.signosVitales.temperatura}}ºC
                                    </td>
                                    <td ng-if="item.signosVitales.respiracion">
                                        <b>Frecuencia respiratoria</b>
                                        <br/>
                                        {{item.signosVitales.respiracion}}
                                        RPM
                                    </td>
                                    <td ng-if="item.signosVitales.spo2">
                                        <b>Saturación O
                                            <sup>2</sup>
                                        </b>
                                        <br/>
                                        {{item.signosVitales.spo2}}%
                                    </td>
                                    <td ng-if="item.signosVitales.peso">
                                        <b>Peso</b>
                                        <br/>
                                        {{item.signosVitales.peso}}
                                        Kg
                                    </td>
                                </tr>

                            </table>
                        </div>

                        <div ng-if="item.balance.$balance">
                            <!-- <table ng-if="item.$total_ingresos || item.$total_ingresos > 0"> -->
                            <table width="100%">

                                <tr>
                                    <th>Ingresos</th>
                                    <th>Egresos</th>
                                    <th>Balance</th>
                                </tr>

                                <tbody>
                                    <tr>
                                        <td>
                                            {{item.balance.$total_ingresos}}
                                        </td>

                                        <td>
                                            {{item.balance.$total_egresos}}
                                        </td>

                                        <td>
                                            {{item.balance.$balance}}
                                            <i class="verde mdi mdi-trending-up" ng-if="item.balance.$balance < 0"></i>
                                            <i class="celeste mdi mdi-trending-flat" ng-if="item.balance.$balance == 0"></i>
                                            <i class="rojo mdi mdi-trending-down" ng-if="item.balance.$balance > 0"></i>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div ng-if="item.riesgoCaida.total">
                            <table width="100%">

                                <tr>
                                    <th>Caídas previas</th>
                                    <th>Marcha</th>
                                    <th>Ayuda para deambular</th>
                                    <th>Venoclisis</th>
                                    <th>Comorbilidad</th>
                                    <th>Estado mental</th>
                                    <th class="text-center">Total</th>
                                </tr>

                                <tbody>
                                    <tr>

                                        <td>
                                            {{item.riesgoCaida.caidasPrevias}}
                                        </td>
                                        <td>
                                            {{item.riesgoCaida.marcha}}
                                        </td>
                                        <td>
                                            {{item.riesgoCaida.ayudaDeambular}}
                                        </td>
                                        <td>
                                            {{item.riesgoCaida.venoclisis}}
                                        </td>
                                        <td>
                                            {{item.riesgoCaida.comorbilidad}}
                                        </td>
                                        <td>
                                            {{item.riesgoCaida.estadoMental}}
                                        </td>

                                        <td class="text-center">
                                            {{item.riesgoCaida.total}}
                                            <br/>
                                            <span ng-if="item.riesgoCaida.total < 25" class="small padding-left padding-right margin-left nivel-verde">Bajo</span>
                                            <span ng-if="item.riesgoCaida.total <= 50" class="small padding-left padding-right margin-left nivel-amarillo">Medio</span>
                                            <span ng-if="item.riesgoCaida.total > 50" class="small padding-left padding-right margin-left nivel-rojo">Alto</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div ng-if="item.glasgow">
                            <!-- <table ng-if="item.$total_ingresos || item.$total_ingresos > 0"> -->
                            <table width="100%">
                                <tr>
                                    <th>Ocular</th>
                                    <th>Verbal</th>
                                    <th>Motor</th>
                                    <th class="text-center">Total</th>
                                </tr>

                                <tbody>
                                    <tr>

                                        <td>
                                            {{item.glasgow.ocular}}
                                        </td>
                                        <td>
                                            {{item.glasgow.verbal}}
                                        </td>
                                        <td>
                                            {{item.glasgow.motor}}
                                        </td>
                                        <td>
                                            {{item.glasgow.total}}
                                        </td>

                                        <td class="text-center">

                                            {{item.glasgow.total}}

                                            <br/>
                                            <span ng-if="item.glasgow.total < 25" class="small padding-left padding-right margin-left nivel-verde">Bajo</span>
                                            <span ng-if="item.glasgow.total >= 25 && item.glasgow.total <= 50" class="small padding-left padding-right margin-left nivel-amarillo">Medio</span>
                                            <span ng-if="item.glasgow.total > 50" class="small padding-left padding-right margin-left nivel-rojo">Alto</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div ng-if="item.riesgoUPP.total">
                            <table width="100%">
                                <tr>
                                    <th>Estado físico</th>
                                    <th>Estado mental</th>
                                    <th>Actividad</th>
                                    <th>Movilidad</th>
                                    <th>Incontinencia</th>
                                    <th class="text-center">Total</th>
                                </tr>

                                <tbody>
                                    <tr>

                                        <td>
                                            {{item.riesgoUPP.estadoFisico}}
                                        </td>
                                        <td>
                                            {{item.riesgoUPP.estadoMental}}
                                        </td>
                                        <td>
                                            {{item.riesgoUPP.actividad}}
                                        </td>
                                        <td>
                                            {{item.riesgoUPP.movilidad}}
                                        </td>
                                        <td>
                                            {{item.riesgoUPP.incontinencia}}
                                        </td>

                                        <td class="text-center">
                                            {{item.riesgoUPP.total}}

                                            <br/>
                                            <span ng-if="item.riesgoUPP.total >= 13 && item.riesgoUPP.total <= 16" class="small padding-left padding-right margin-left nivel-verde">Bajo</span>
                                            <span ng-if="item.riesgoUPP.total >= 10 && item.riesgoUPP.total <= 12" class="small padding-left padding-right margin-left nivel-amarillo">Medio</span>
                                            <span ng-if="item.riesgoUPP.total >= 5 && item.riesgoUPP.total <= 9" class="small padding-left padding-right margin-left nivel-rojo">Alto</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div ng-if="item.dolorValoracion.intensidad">
                            <table width="100%">
                                <tr>
                                    <th>Analgesia previa</th>
                                    <th>Ansiolíticos previos</th>
                                    <th>Intensidad</th>
                                    <th>Características del dolor</th>
                                    <th>Observaciones</th>
                                </tr>
                                <tbody>
                                    <tr>
                                        <td>
                                            <span ng-if="item.dolorValoracion.analgesiaAutomedicacion">Automedicación</span>
                                            <span ng-if="!item.dolorValoracion.analgesiaAutomedicacion">Indicada por médico</span>
                                        </td>
                                        <td>
                                            <span ng-if="item.dolorValoracion.ansioliticosAutomedicacion">Automedicación</span>
                                            <span ng-if="!item.dolorValoracion.ansioliticosAutomedicacion">Indicada por médico</span>
                                        </td>
                                        <td>
                                            <span ng-if="item.dolorValoracion.intensidad == 0">Sin dolor</span>
                                            <span ng-if="item.dolorValoracion.intensidad == 10">Máximo dolor</span>
                                            <span ng-if="item.dolorValoracion.intensidad > 0 && item.dolorValoracion.intensidad < 10">{{item.dolorValoracion.intensidad}}</span>
                                        </td>
                                        <td>
                                            <span ng-if="item.dolorValoracion.punzante">Punzante</span>
                                            <span ng-if="item.dolorValoracion.tipoColico">Tipo cólico</span>
                                            <span ng-if="item.dolorValoracion.pesadez">Pesadez</span>
                                            <span ng-if="item.dolorValoracion.pulsante">Pulsante</span>
                                            <span ng-if="item.dolorValoracion.hormigueo">Hormigueo</span>

                                        </td>
                                        <td>
                                            <div ng-if="item.dolorValoracion.descripcion">
                                                <b>Descripcion:</b>
                                                {{item.dolorValoracion.descripcion}}
                                                <br/>
                                            </div>
                                            <div ng-if="item.dolorValoracion.dolorLocalizacion">
                                                <b>Localización dolor:</b>
                                                {{item.dolorValoracion.dolorLocalizacion}}
                                                <br/>
                                            </div>
                                            <div ng-if="item.dolorValoracion.observacionesDolor">
                                                <b>Observaciones:</b>
                                                {{item.dolorValoracion.observacionesDolor}}
                                                <br/>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div ng-if="item.aislamiento">
                            {{item.aislamiento.descripcion}}
                        </div>
                        <div ng-if="item.medicamento">
                            <b>{{item.tipoIndicacion.nombre}}</b>
                            <br />
                            {{item.medicamento.descripcion}}
                        </div>
                        <div ng-if="item.rotarDecubito">
                            Punto apoyo:
                            {{item.rotarDecubito.puntoApoyo}}
                            <br/>
                            Posición:
                            {{item.rotarDecubito.posicion}}
                        </div>

                    </td>
                    <td >
                        <button class="btn btn-flat btn-sm tips" title="Ver detalle de la evolución" ng-click="verEvolucion(item.id)">
                            <i class="mdi mdi-eye"></i>
                        </button>
                    </td>
                    <td >
                        {{item.createdBy.name}}
                        <br/>
                        {{item.servicio.nombreCorto}}
                    </td>
                    <td ></td>
                </tr>
            </tbody>
        </table>

        <p ng-if="!internacion.evoluciones.length">No se han cargado evoluciones</p>

    </div>

    <div ng-show="evolucionesEdit">
        <ng-form name="formEditarEvolucion" ng-show="!loading">
            <fieldset>
                <div class="row">
                    <div class="col-lg-12" > <!-- plex-tabs ng-model="tab" -->
                        <div class="row">
                            <div class="col-lg-9" >
                                <div class="card card-block ">
                                    <fieldset>
                                        <legend>Cargar evolución</legend>
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <textarea label="Texto de la evolución" placeholder="Consignar los tratamientos y cuidados efectuados y los síntomas observados" plex-focus="true" ng-model="evolucionesEdit.texto" plex ui-tinymce="tinymceOptions" ng-required="true" rows="3" class="form-control"></textarea>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-xs-3">
                                                <div class="form-group">
                                                    <input type="text" label="Fecha evolución" ng-model="evolucionesEdit.fechaHora" plex="date">
                                                </div>
                                            </div>

                                            <div class="col-xs-3">
                                                <div class="form-group">
                                                    <input type="text" label="Hora evolución" ng-model="evolucionesEdit.fechaHora" plex="time">
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class=" margin-top text-right">
                                                    <button type="button" class="btn btn-default btn-flat" ng-click="cancelarEdicion();">Cancelar</button>
                                                    <button class="btn btn-primary" plex-submit="guardarEvolucion(evolucionesEdit)" ng-disabled="formEditarEvolucion.$invalid">
                                                        <i class="mdi mdi-content-save"></i>
                                                        Guardar
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </fieldset>
                                </div>

                            </div>
                            <div class="col-lg-3 ">
                                <div class="card card-block " style="border: 4px dashed #ececec; background: #f9f9f9;">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <h5>Visualización de datos importantes</h5>
                                        </div>
                                    </div>

                                    <div class="row mb">
                                        <!-- style="border: 4px dashed #ececec; background: #f9f9f9; " -->

                                        <div class="col-lg-12">
                                            <select class="" label="Ultimos valores de" ng-model="tipoWidget" plex="(w.nombre) for w in tiposWidgets"></select>
                                        </div>
                                    </div>
                                    <div class="row mb">
                                        <div class="col-lg-12">

                                            <button type="button" class="btn btn-info form-control" ng-click="widgets.cargar()" ng-disabled="!tipoWidget.id">
                                                Cargar
                                            </button>
                                            <!-- <li class="" style="width: 33.3%; display: inline-block; ">
                                            <div style="border: 4px dashed #ececec; background: #f9f9f9; min-height: 300px; padding-top: 80px;">
                                                <div class="row">
                                                    <div class="col-lg-offset-4 col-lg-4">
                                                        <ng-form >
                                                            <select class="form-control" label="Ultimos valores de" ng-model="tipoWidget" plex="(w.nombre) for w in tiposWidgets"></select>
                                                            <button type="button" class="btn btn-info" ng-click="widgets.cargar()" ng-disabled="!tipoWidget.id">
                                                                Cargar resumen
                                                            </button>
                                                        </ng-form>
                                                    </div>
                                                </div>
                                            </div>
                                        </li> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="row" ng-show="wigetCargados.length">
                    <div class="col-lg-12">
                        <div class="card card-block ">
                            <div class="">



                                <div class="row" style="position: relative; width: 100%;">

                                    <div class="col-lg-12" style="overflow: hidden; position: relative; white-space: nowrap;" ng-show="wigetCargados.length">
                                        <ul class="widgets" style="overflow-x: auto; overflow-y: hidden;padding-left: 10px; padding: 10px 10px 30px 10px;"  drag-scroll="true">
                                            <!-- <li class="" style="width: 33.3%; display: inline-block; white-space: normal;">
                                                <div style="border: 4px dashed #ececec; background: #f9f9f9; min-height: 300px; padding-top: 80px;">
                                                    <div class="row">
                                                        <div class="col-lg-offset-4 col-lg-4">
                                                            <ng-form >
                                                                <select class="form-control" label="Ultimos valores de" ng-model="tipoWidget" plex="(w.nombre) for w in tiposWidgets"></select>
                                                                <button type="button" class="btn btn-info" ng-click="widgets.cargar()" ng-disabled="!tipoWidget.id">
                                                                    Cargar resumen
                                                                </button>
                                                            </ng-form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </li> -->
                                            <li class="" ng-repeat="widget in wigetCargados track by $index">

                                                <div class="row header-widget">
                                                    <div class="col-lg-10 title">
                                                        {{widget.title}}
                                                    </div>
                                                    <div class="col-lg-2 text-right">
                                                        <button class="link close" ng-click="widgets.quitar($index)">
                                                            <i class="mdi mdi-close"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="content-widget" ng-if="widget.signosVitales" >

                                                    <div class="row">
                                                        <div ng-if="widget.signosVitales.pulso">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">
                                                                    Frecuencia cardíaca
                                                                </b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.pulso}}
                                                                PPM
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.respiracion">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">
                                                                    Frecuencia respiratoria
                                                                </b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.respiracion}}
                                                                RPM
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.circulacion.tensionSistolica">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">
                                                                    Tensión sistólica
                                                                </b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.circulacion.tensionSistolica}}
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.circulacion.tensionDiastolica">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">
                                                                    Tensión diastólica
                                                                </b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.circulacion.tensionDiastolica}}
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.temperatura">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">
                                                                    Temperatura
                                                                </b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.temperatura}}ºC
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.spo2">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">
                                                                    Saturación O
                                                                    <sup>2</sup>
                                                                </b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.spo2}}%
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.peso">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">Peso</b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.peso}}
                                                                Kg
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.circulacion.pedio">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">Pulso pedio</b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.circulacion.pedio}}
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.circulacion.popliteo">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">Pulso popliteo</b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.circulacion.popliteo}}
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.circulacion.radial">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">Pulso radial</b>
                                                            </div>

                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.circulacion.radial}}
                                                            </div>
                                                        </div>

                                                        <div ng-if="widget.signosVitales.circulacion.carotideo">
                                                            <div class="col-md-4">
                                                                <b class="text-uppercase">Pulso carotideo</b>
                                                            </div>
                                                            <div class="col-md-2">
                                                                {{widget.signosVitales.circulacion.carotideo}}
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row" ng-if="widget.signosVitales.circulacion.observacionesCirculacion">

                                                        <div class="col-md-12">
                                                            <br/><br/><br/>
                                                            <b class="text-uppercase">Observaciones circulación</b>
                                                            <br/>
                                                            {{widget.signosVitales.circulacion.observacionesCirculacion}}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="content-widget" ng-if="widget.riesgoUPP" >
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-md-2">
                                                                <b>Estado físico</b>
                                                                <br />
                                                                {{widget.riesgoUPP.estadoFisico}}
                                                            </div>
                                                            <div class="col-md-2">
                                                                <b>Estado mental</b>
                                                                <br />
                                                                {{widget.riesgoUPP.estadoMental}}
                                                            </div>
                                                            <div class="col-md-2">
                                                                <b>Actividad</b>
                                                                <br />
                                                                {{widget.riesgoUPP.actividad}}
                                                            </div>
                                                            <div class="col-md-2">
                                                                <b>Movilidad</b>
                                                                <br />
                                                                {{widget.riesgoUPP.movilidad}}
                                                            </div>
                                                            <div class="col-md-2">
                                                                <b>Incontinencia</b>
                                                                <br />
                                                                {{widget.riesgoUPP.incontinencia}}
                                                            </div>
                                                            <div class="col-md-2">
                                                                <b>Total</b>
                                                                <br />
                                                                {{widget.riesgoUPP.total}}

                                                                <span ng-if="widget.riesgoUPP.total >= 13 && widget.riesgoUPP.total <= 16" class="small padding-left padding-right margin-left nivel-verde">Bajo</span>
                                                                <span ng-if="widget.riesgoUPP.total >= 10 && widget.riesgoUPP.total <= 12" class="small padding-left padding-right margin-left nivel-amarillo">Medio</span>
                                                                <span ng-if="widget.riesgoUPP.total >= 5 && widget.riesgoUPP.total <= 9" class="small padding-left padding-right margin-left nivel-rojo">Alto</span>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <h4>Ulceras en el cuerpo</h4>
                                                            </div>
                                                        </div>

                                                        <div class="row">
                                                            <div class="col-md-3 text-center">

                                                                <svg ng-attr-height="{{graph.height}}" ng-attr-width="{{graph.width}}">
                                                                    <image sketch:type="MSBitmapLayer" width="100%" height="100%" xlink:href="img/hombre-frente.jpg" ></image>

                                                                    <g ng-repeat="ele in widget.riesgoUPP.lesionesFrente track by $index">
                                                                        <g ng-switch on="ele.tipo">
                                                                            <circle ng-switch-when="0" ng-attr-cx="{{ele.x}}" ng-attr-cy="{{ele.y}}" ng-attr-r="{{radius}}" stroke-width="{{sw}}" class="{'focus':ele.f===1} tips" title="{{$index}}">
                                                                                <text x="50%" y="50%" text-anchor="middle" stroke="#51c5cf" stroke-width="2px" dy=".3em">{{$index}}</text>
                                                                            </circle>
                                                                        </g>
                                                                    </g>
                                                                </svg>
                                                                <p>
                                                                    <b>Frente</b>
                                                                </p>
                                                            </div>
                                                            <div class="col-md-3 text-center">
                                                                <svg ng-attr-height="{{graph.height}}" ng-attr-width="{{graph.width}}">
                                                                    <image sketch:type="MSBitmapLayer" width="100%" height="100%" xlink:href="img/hombre-espalda.jpg" ></image>

                                                                    <g ng-repeat="ele in widget.riesgoUPP.lesionesEspalda track by $index">
                                                                        <g ng-switch on="ele.tipo">
                                                                            <circle ng-switch-when="0" ng-attr-cx="{{ele.x}}" ng-attr-cy="{{ele.y}}" ng-attr-r="{{radius}}" stroke-width="{{sw}}" class="{'focus':ele.f===1} tips" title="{{$index}}">
                                                                                <text x="50%" y="50%" text-anchor="middle" stroke="#51c5cf" stroke-width="2px" dy=".3em">{{$index}}</text>
                                                                            </circle>
                                                                        </g>
                                                                    </g>
                                                                </svg>
                                                                <p>
                                                                    <b>Espalda</b>
                                                                </p>
                                                            </div>
                                                            <div class="col-md-3 text-center">
                                                                <svg ng-attr-height="{{graph.height}}" ng-attr-width="{{graph.width}}">
                                                                    <image sketch:type="MSBitmapLayer" width="100%" height="100%" xlink:href="img/hombre-izquierda.jpg" ></image>

                                                                    <g ng-repeat="ele in widget.riesgoUPP.lesionesLadoIzquierdo track by $index">
                                                                        <g ng-switch on="ele.tipo">
                                                                            <circle ng-switch-when="0" ng-attr-cx="{{ele.x}}" ng-attr-cy="{{ele.y}}" ng-attr-r="{{radius}}" stroke-width="{{sw}}" class="{'focus':ele.f===1} tips" title="{{$index}}">
                                                                                <text x="50%" y="50%" text-anchor="middle" stroke="#51c5cf" stroke-width="2px" dy=".3em">{{$index}}</text>
                                                                            </circle>
                                                                        </g>
                                                                    </g>
                                                                </svg>
                                                                <p>
                                                                    <b>Lado izquierdo</b>
                                                                </p>
                                                            </div>
                                                            <div class="col-md-3 text-center">
                                                                <svg ng-attr-height="{{graph.height}}" ng-attr-width="{{graph.width}}">
                                                                    <image sketch:type="MSBitmapLayer" width="100%" height="100%" xlink:href="img/hombre-derecha.jpg" ></image>


                                                                    <g ng-repeat="ele in widget.riesgoUPP.lesionesLadoDerecho track by $index">
                                                                        <g ng-switch on="ele.tipo">
                                                                            <circle ng-switch-when="0" ng-attr-cx="{{ele.x}}" ng-attr-cy="{{ele.y}}" ng-attr-r="{{radius}}" stroke-width="{{sw}}" class="{'focus':ele.f===1} tips" title="{{$index}}">
                                                                                <text x="50%" y="50%" text-anchor="middle" stroke="#51c5cf" stroke-width="2px" dy=".3em">{{$index}}</text>
                                                                            </circle>
                                                                        </g>
                                                                    </g>
                                                                </svg>
                                                                <p>
                                                                    <b>Lado derecho</b>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="content-widget" ng-if="widget.flebitis">
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">
                                                                Grado flebitis
                                                            </b>
                                                        </div>

                                                        <div class="col-md-3">
                                                            {{widget.flebitis.grado}}
                                                        </div>

                                                    </div>
                                                </div>

                                                <div class="content-widget" ng-if="widget.glasgow">
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">
                                                                Ocular
                                                            </b>

                                                        </div>
                                                        <div class="col-md-3">
                                                            {{widget.glasgow.ocular}}
                                                        </div>

                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">
                                                                Verbal
                                                            </b>
                                                        </div>

                                                        <div class="col-md-3">
                                                            {{widget.glasgow.verbal}}
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Motor</b>
                                                        </div>

                                                        <div class="col-md-3">
                                                            {{widget.glasgow.motor}}
                                                        </div>

                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Total</b>
                                                        </div>

                                                        <div class="col-md-3">
                                                            {{widget.glasgow.total}}

                                                            <span ng-if="widget.glasgow.total < 25" class="small padding-left padding-right margin-left nivel-verde">Bajo</span>
                                                            <span ng-if="widget.glasgow.total >= 25 && widget.glasgow.total <= 50" class="small padding-left padding-right margin-left nivel-amarillo">Medio</span>
                                                            <span ng-if="widget.glasgow.total > 50" class="small padding-left padding-right margin-left nivel-rojo">Alto</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="content-widget" ng-if="widget.riesgoCaida">
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Caídas previas</b>
                                                        </div>
                                                        <div class="col-md-3">
                                                            {{widget.riesgoCaida.caidasPrevias}}
                                                        </div>
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Marcha</b>
                                                        </div>
                                                        <div class="col-md-3">
                                                            {{widget.riesgoCaida.marcha}}
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Ayuda para deambular</b>
                                                        </div>
                                                        <div class="col-md-3">
                                                            {{widget.riesgoCaida.ayudaDeambular}}
                                                        </div>
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Venoclisis</b>
                                                        </div>
                                                        <div class="col-md-3">
                                                            {{widget.riesgoCaida.venoclisis}}
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Comorbilidad</b>
                                                        </div>

                                                        <div class="col-md-3">
                                                            {{widget.riesgoCaida.comorbilidad}}
                                                        </div>

                                                        <div class="col-md-3">
                                                            <b class="text-uppercase">Estado mental</b>
                                                        </div>

                                                        <div class="col-md-3">
                                                            {{widget.riesgoCaida.estadoMental}}
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12 text-right">
                                                            <b class="text-uppercase">Total</b>
                                                            {{widget.riesgoCaida.total}}

                                                            <span ng-if="widget.riesgoCaida.total < 25" class="small padding-left padding-right margin-left nivel-verde">Bajo</span>
                                                            <span ng-if="widget.riesgoCaida.total <= 50" class="small padding-left padding-right margin-left nivel-amarillo">Medio</span>
                                                            <span ng-if="widget.riesgoCaida.total > 50" class="small padding-left padding-right margin-left nivel-rojo">Alto</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="content-widget" ng-if="widget.balance">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <h5>Ingresos <span class="text-muted small">{{widget.balance.$total_ingresos}} ml</span></h5>
                                                            <div class="row">
                                                                <div ng-repeat="ingreso in widget.balance.ingresos">
                                                                    <!-- <pre>
                                                                    {{ingreso | json}}
                                                                    </pre> -->
                                                                    <div class="col-md-4 mb" ng-if="ingreso.hidratacion.parenteral">
                                                                        <b class="text-uppercase">Plan de hidratación parenteral</b>
                                                                        <div ng-if="ingreso.hidratacion.parenteral.solucionFisiologica">
                                                                            <b >
                                                                                Solución fisiológica:
                                                                            </b>

                                                                            {{ingreso.hidratacion.parenteral.solucionFisiologica}} ml
                                                                        </div>
                                                                        <div ng-if="ingreso.hidratacion.parenteral.dextrosa">
                                                                            <b >
                                                                                Dextrosa:
                                                                            </b>
                                                                            {{ingreso.hidratacion.parenteral.dextrosa}} ml
                                                                        </div>
                                                                        <div ng-if="ingreso.hidratacion.parenteral.ringerLactato">
                                                                            <b >
                                                                                Ringer-Lactato:
                                                                            </b>
                                                                            {{ingreso.hidratacion.parenteral.ringerLactato}} ml
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4 mb" ng-if="ingreso.hidratacion.enteral">
                                                                        <b class="text-uppercase">
                                                                            Plan de hidratación enteral
                                                                        </b>
                                                                        <div ng-if="ingreso.hidratacion.enteral.solucionFisiologica">

                                                                            <b>
                                                                                Solución fisiológica:
                                                                            </b>
                                                                            {{ingreso.hidratacion.enteral.solucionFisiologica}} ml
                                                                        </div>
                                                                        <div ng-if="ingreso.hidratacion.enteral.dextrosa">
                                                                            <b >
                                                                                Dextrosa:
                                                                            </b>
                                                                            {{ingreso.hidratacion.enteral.dextrosa}} ml
                                                                        </div>
                                                                        <div ng-if="ingreso.hidratacion.enteral.ringerLactato">
                                                                            <b >
                                                                                Ringer-Lactato:
                                                                            </b>
                                                                            {{ingreso.hidratacion.enteral.ringerLactato}} ml
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4 mb" ng-if="ingreso.hidratacion.oral">
                                                                        <p ng-if="ingreso.hidratacion.oral.cantidad">
                                                                            <b class="text-uppercase">
                                                                                Hidratación oral:
                                                                            </b>
                                                                            {{ingreso.hidratacion.oral.cantidad}} ml
                                                                        </p>
                                                                    </div>
                                                                    <div class="col-md-4" ng-if="ingreso.medicamentos">
                                                                        <p ng-if="ingreso.medicamentos.cantidad">
                                                                            <b class="text-uppercase">
                                                                                Medicamentos:
                                                                            </b>
                                                                            <br />
                                                                            {{ingreso.medicamentos.descripcion}}: {{ingreso.medicamentos.cantidad}} ml
                                                                            <span ng-if="ingreso.medicamentos.observaciones">
                                                                                <br />
                                                                                Observaciones: {{ingreso.medicamentos.observaciones}}
                                                                            </span>
                                                                        </p>
                                                                    </div>
                                                                    <div class="col-md-4" ng-if="ingreso.nutricion">
                                                                        <b class="text-uppercase">Nutrición</b>
                                                                        <div ng-if="ingreso.nutricion.soporteOral">
                                                                            <p ng-if="ingreso.nutricion.soporteOral.cantidad">
                                                                                <b>
                                                                                Soporte oral
                                                                                </b>
                                                                                {{ingreso.nutricion.soporteOral.cantidad}} ml
                                                                            </p>
                                                                        </div>
                                                                        <div ng-if="ingreso.nutricion.enteral">
                                                                            <p ng-if="ingreso.nutricion.enteral.cantidad">
                                                                                <b>
                                                                                    Enteral
                                                                                </b>
                                                                                {{ingreso.nutricion.enteral.cantidad}} ml
                                                                            </p>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4" ng-if="ingreso.hemoterapia">
                                                                        <p ng-if="ingreso.hemoterapia.cantidad">
                                                                            <b class="text-uppercase">
                                                                                Hemoterapia:
                                                                            </b>
                                                                            <br />
                                                                            {{ingreso.hemoterapia.cantidad}} ml
                                                                            <br />
                                                                            {{ingreso.hemoterapia.descripcion}}
                                                                        </p>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <h5>Egresos <span class="text-muted small">{{widget.balance.$total_egresos}} ml</span></h5>
                                                            <div class="row">
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.lavadoVesicalI">
                                                                        Lavado vesical:
                                                                        <b>
                                                                            {{widget.balance.egresos.lavadoVesicalI}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.diuresis">
                                                                        Diuresis:
                                                                        <b>
                                                                            {{widget.balance.egresos.diuresis}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.catarsis">
                                                                        Catarsis:
                                                                        <b>
                                                                            {{widget.balance.egresos.catarsis}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.sng">
                                                                        SNG:
                                                                        <b>
                                                                            {{widget.balance.egresos.sng}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.sny">
                                                                        SNY:
                                                                        <b>
                                                                            {{widget.balance.egresos.sny}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.ostomias">
                                                                        Ostomías:
                                                                        <b>
                                                                            {{widget.balance.egresos.ostomias}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.ostomias2">
                                                                        Ostomías 2:
                                                                        <b>
                                                                            {{widget.balance.egresos.ostomias2}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.residuoGastrico">
                                                                        Residuo gástrico:
                                                                        <b>
                                                                            {{widget.balance.egresos.residuoGastrico}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-if="widget.balance.egresos.secrecionesApiradas">
                                                                        Secreciones aspiradas:
                                                                        <b>
                                                                            {{widget.balance.egresos.secrecionesApiradas}} ml
                                                                        </b>
                                                                    </p>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <p ng-repeat="drenaje in widget.balance.egresos.drenajes track by $index">
                                                                        <div ng-show="drenajes[$index].cantidad">
                                                                            {{drenaje.tipo}}, lado
                                                                            {{drenaje.lado}}
                                                                            {{drenajes[$index].cantidad}}
                                                                            ml ({{drenajes[$index].caracteristicaLiquido}})
                                                                        </div>
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <h5>Total balance
                                                                <span class="text-muted small">
                                                                    {{widget.balance.$balance}} ml
                                                                    <i class="verde mdi mdi-trending-up" ng-if="widget.balance.$balance < 0"></i>
                                                                    <i class="celeste mdi mdi-trending-flat" ng-if="widget.balance.$balance == 0"></i>
                                                                    <i class="rojo mdi mdi-trending-down" ng-if="widget.balance.$balance > 0"></i>
                                                                </span>
                                                            </h5>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="content-widget" ng-if="widget.dolorValoracion">
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <b class="text-uppercase">Ansiolíticos previos</b>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <span ng-if="widget.dolorValoracion.ansioliticosAutomedicacion">Automedicación</span>
                                                            <span ng-if="!widget.dolorValoracion.ansioliticosAutomedicacion">Indicada por médico</span>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <b class="text-uppercase">Intensidad</b>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <span ng-if="widget.dolorValoracion.intensidad == 0">Sin dolor</span>
                                                            <span ng-if="widget.dolorValoracion.intensidad == 10">Máximo dolor</span>
                                                            <span ng-if="widget.dolorValoracion.intensidad > 0 && widget.dolorValoracion.intensidad < 10">{{widget.dolorValoracion.intensidad}}</span>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <b class="text-uppercase">Características del dolor</b>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <span ng-if="widget.dolorValoracion.punzante">
                                                                Punzante
                                                                <br />
                                                            </span>

                                                            <span ng-if="widget.dolorValoracion.tipoColico">
                                                                Tipo cólico
                                                                <br />
                                                            </span>

                                                            <span ng-if="widget.dolorValoracion.pesadez">
                                                                Pesadez<br />
                                                            </span>

                                                            <span ng-if="widget.dolorValoracion.pulsante">
                                                                Pulsante
                                                                <br />
                                                            </span>

                                                            <span ng-if="widget.dolorValoracion.hormigueo">
                                                                Hormigueo
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div class="row" ng-show="widget.dolorValoracion.descripcion
                                                        || widget.dolorValoracion.dolorLocalizacion
                                                        || widget.dolorValoracion.observacionesDolor">
                                                        <div class="col-md-6">
                                                            <b class="text-uppercase">Observaciones</b>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <div ng-if="widget.dolorValoracion.descripcion">
                                                                <b class="text-uppercase">Descripcion:</b>
                                                                {{widget.dolorValoracion.descripcion}}
                                                                <br />
                                                            </div>
                                                            <div ng-if="widget.dolorValoracion.dolorLocalizacion">
                                                                <b class="text-uppercase">Localización dolor:</b>
                                                                {{widget.dolorValoracion.dolorLocalizacion}}
                                                                <br />
                                                            </div>
                                                            <div ng-if="widget.dolorValoracion.observacionesDolor">
                                                                <b class="text-uppercase">Observaciones:</b>
                                                                {{widget.dolorValoracion.observacionesDolor}}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="content-widget" ng-if="widget.problemas">
                                                    <table class="table table-hover table-striped" ng-if="widget.problemas.activos">
                                                        <thead >
                                                            <tr>
                                                                <th>
                                                                    Activos
                                                                </th>
                                                                <th >
                                                                    Problema
                                                                </th>
                                                                <th >
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr data-ng-repeat="item in widget.problemas.activos | orderBy: '-fechaDesde'">
                                                                <td >
                                                                    {{item.fechaDesde | fromNow }}<br/>
                                                                    <div class="text-muted small">
                                                                        {{item.fechaDesde | date: "dd/MM/yyyy HH:mm"}}
                                                                    </div>
                                                                </td>
                                                                <td >
                                                                    <span ng-if="item.diagnostico.nombre">
                                                                        {{item.diagnostico.nombre}}
                                                                    </span>
                                                                    <span ng-if="!item.diagnostico.nombre">
                                                                        {{item.diagnosticoTexto}}
                                                                    </span>

                                                                    <br />
                                                                    {{item.descripcion}}
                                                                </td>
                                                                <td >
                                                                    <span class="label label-warning" ng-if="item.esCronico">Crónico</span>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <table class="table table-hover table-striped" ng-if="widget.problemas.inactivos">
                                                        <thead >
                                                            <tr>
                                                                <th>
                                                                    Inactivos
                                                                </th>
                                                                <th >
                                                                    Problema
                                                                </th>
                                                                <th >
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr data-ng-repeat="item in widget.problemas.inactivos | orderBy: '-fechaDesde'">
                                                                <td >
                                                                    {{item.fechaDesde | fromNow }}<br/>
                                                                    <div class="text-muted small">
                                                                        {{item.fechaDesde | date: "dd/MM/yyyy HH:mm"}}
                                                                    </div>
                                                                </td>
                                                                <td >
                                                                    <span ng-if="item.diagnostico.nombre">
                                                                        {{item.diagnostico.nombre}}
                                                                    </span>
                                                                    <span ng-if="!item.diagnostico.nombre">
                                                                        {{item.diagnosticoTexto}}
                                                                    </span>

                                                                    <br />
                                                                    {{item.descripcion}}
                                                                </td>
                                                                <td >
                                                                    <span class="label label-warning" ng-if="item.esCronico">Crónico</span>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </li>

                                        </ul>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                </fieldset>
            </ng-form>

        </div>

    </div>
